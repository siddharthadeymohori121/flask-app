<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nifty50 Stocks</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .error {
            color: red;
        }
        .card {
            margin-top: 20px;
        }
        table {
            margin-top: 20px;
        }
    </style>
</head>
<body wfd-invisible="true">
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Nifty50 Stocks</a>
            <div class="collapse navbar-collapse justify-content-end">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#uploadModal">Upload</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h1 class="text-center my-4">Nifty50 Stock Information</h1>

        <!-- Stock Selection -->
        <div class="card">
            <div class="card-body">
                <h2>Select a Stock</h2>
                <label for="stock-select" class="form-label">Choose a stock to view details:</label>
                <select id="stock-select" class="form-select">
                    <option value="all">-- All Stocks --</option>
                <option value="NIFTY 50">NIFTY 50 - N/A</option><option value="SHRIRAMFIN">SHRIRAMFIN - N/A</option><option value="BAJAJFINSV">BAJAJFINSV - N/A</option><option value="HCLTECH">HCLTECH - N/A</option><option value="WIPRO">WIPRO - N/A</option><option value="INFY">INFY - N/A</option><option value="SBIN">SBIN - N/A</option><option value="BAJFINANCE">BAJFINANCE - N/A</option><option value="APOLLOHOSP">APOLLOHOSP - N/A</option><option value="KOTAKBANK">KOTAKBANK - N/A</option><option value="ICICIBANK">ICICIBANK - N/A</option><option value="M&amp;M">M&amp;M - N/A</option><option value="COALINDIA">COALINDIA - N/A</option><option value="TITAN">TITAN - N/A</option><option value="TATASTEEL">TATASTEEL - N/A</option><option value="TATAMOTORS">TATAMOTORS - N/A</option><option value="SUNPHARMA">SUNPHARMA - N/A</option><option value="BRITANNIA">BRITANNIA - N/A</option><option value="JSWSTEEL">JSWSTEEL - N/A</option><option value="INDUSINDBK">INDUSINDBK - N/A</option><option value="ITC">ITC - N/A</option><option value="BEL">BEL - N/A</option><option value="ASIANPAINT">ASIANPAINT - N/A</option><option value="HEROMOTOCO">HEROMOTOCO - N/A</option><option value="HINDUNILVR">HINDUNILVR - N/A</option><option value="HDFCBANK">HDFCBANK - N/A</option><option value="BPCL">BPCL - N/A</option><option value="HINDALCO">HINDALCO - N/A</option><option value="NTPC">NTPC - N/A</option><option value="TCS">TCS - N/A</option><option value="POWERGRID">POWERGRID - N/A</option><option value="NESTLEIND">NESTLEIND - N/A</option><option value="ULTRACEMCO">ULTRACEMCO - N/A</option><option value="SBILIFE">SBILIFE - N/A</option><option value="TATACONSUM">TATACONSUM - N/A</option><option value="MARUTI">MARUTI - N/A</option><option value="EICHERMOT">EICHERMOT - N/A</option><option value="LT">LT - N/A</option><option value="BAJAJ-AUTO">BAJAJ-AUTO - N/A</option><option value="AXISBANK">AXISBANK - N/A</option><option value="RELIANCE">RELIANCE - N/A</option><option value="CIPLA">CIPLA - N/A</option><option value="ONGC">ONGC - N/A</option><option value="TECHM">TECHM - N/A</option><option value="GRASIM">GRASIM - N/A</option><option value="TRENT">TRENT - N/A</option><option value="HDFCLIFE">HDFCLIFE - N/A</option><option value="ADANIENT">ADANIENT - N/A</option><option value="ADANIPORTS">ADANIPORTS - N/A</option><option value="DRREDDY">DRREDDY - N/A</option><option value="BHARTIARTL">BHARTIARTL - N/A</option><option value="NIFTY 50">NIFTY 50 - N/A</option><option value="SHRIRAMFIN">SHRIRAMFIN - N/A</option><option value="BAJAJFINSV">BAJAJFINSV - N/A</option><option value="HCLTECH">HCLTECH - N/A</option><option value="WIPRO">WIPRO - N/A</option><option value="INFY">INFY - N/A</option><option value="SBIN">SBIN - N/A</option><option value="BAJFINANCE">BAJFINANCE - N/A</option><option value="APOLLOHOSP">APOLLOHOSP - N/A</option><option value="KOTAKBANK">KOTAKBANK - N/A</option><option value="ICICIBANK">ICICIBANK - N/A</option><option value="M&amp;M">M&amp;M - N/A</option><option value="COALINDIA">COALINDIA - N/A</option><option value="TITAN">TITAN - N/A</option><option value="TATASTEEL">TATASTEEL - N/A</option><option value="TATAMOTORS">TATAMOTORS - N/A</option><option value="SUNPHARMA">SUNPHARMA - N/A</option><option value="BRITANNIA">BRITANNIA - N/A</option><option value="JSWSTEEL">JSWSTEEL - N/A</option><option value="INDUSINDBK">INDUSINDBK - N/A</option><option value="ITC">ITC - N/A</option><option value="BEL">BEL - N/A</option><option value="ASIANPAINT">ASIANPAINT - N/A</option><option value="HEROMOTOCO">HEROMOTOCO - N/A</option><option value="HINDUNILVR">HINDUNILVR - N/A</option><option value="HDFCBANK">HDFCBANK - N/A</option><option value="BPCL">BPCL - N/A</option><option value="HINDALCO">HINDALCO - N/A</option><option value="NTPC">NTPC - N/A</option><option value="TCS">TCS - N/A</option><option value="POWERGRID">POWERGRID - N/A</option><option value="NESTLEIND">NESTLEIND - N/A</option><option value="ULTRACEMCO">ULTRACEMCO - N/A</option><option value="SBILIFE">SBILIFE - N/A</option><option value="TATACONSUM">TATACONSUM - N/A</option><option value="MARUTI">MARUTI - N/A</option><option value="EICHERMOT">EICHERMOT - N/A</option><option value="LT">LT - N/A</option><option value="BAJAJ-AUTO">BAJAJ-AUTO - N/A</option><option value="AXISBANK">AXISBANK - N/A</option><option value="RELIANCE">RELIANCE - N/A</option><option value="CIPLA">CIPLA - N/A</option><option value="ONGC">ONGC - N/A</option><option value="TECHM">TECHM - N/A</option><option value="GRASIM">GRASIM - N/A</option><option value="TRENT">TRENT - N/A</option><option value="HDFCLIFE">HDFCLIFE - N/A</option><option value="ADANIENT">ADANIENT - N/A</option><option value="ADANIPORTS">ADANIPORTS - N/A</option><option value="DRREDDY">DRREDDY - N/A</option><option value="BHARTIARTL">BHARTIARTL - N/A</option></select>
                <button class="btn btn-secondary mt-3" onclick="handleStockSelection()">Show</button>
                <div id="stocks-table" class="mt-4">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Symbol</th>
                    <th>Day High</th>
                    <th>Day Low</th>
                    <th>Last Price</th>
                    <th>Change</th>
                    <th>PChange</th>
                </tr>
            </thead>
            <tbody>
                
                    <tr>
                        <td>NIFTY 50</td>
                        <td>24677.8</td>
                        <td>24510.65</td>
                        <td>24610.05</td>
                        <td>-8.950000000000728</td>
                        <td>-0.04</td>
                    </tr>
                
                    <tr>
                        <td>SHRIRAMFIN</td>
                        <td>3197.15</td>
                        <td>3109</td>
                        <td>3181.6</td>
                        <td>74.7</td>
                        <td>2.4</td>
                    </tr>
                
                    <tr>
                        <td>BAJAJFINSV</td>
                        <td>1673</td>
                        <td>1637.1</td>
                        <td>1664</td>
                        <td>26.95</td>
                        <td>1.65</td>
                    </tr>
                
                    <tr>
                        <td>HCLTECH</td>
                        <td>1942.8</td>
                        <td>1912.2</td>
                        <td>1937</td>
                        <td>27.1</td>
                        <td>1.42</td>
                    </tr>
                
                    <tr>
                        <td>WIPRO</td>
                        <td>311</td>
                        <td>303.45</td>
                        <td>308</td>
                        <td>4.25</td>
                        <td>1.4</td>
                    </tr>
                
                    <tr>
                        <td>INFY</td>
                        <td>1965.6</td>
                        <td>1932</td>
                        <td>1947.1</td>
                        <td>23.45</td>
                        <td>1.22</td>
                    </tr>
                
                    <tr>
                        <td>SBIN</td>
                        <td>868.95</td>
                        <td>858.05</td>
                        <td>868.3</td>
                        <td>10.25</td>
                        <td>1.19</td>
                    </tr>
                
                    <tr>
                        <td>BAJFINANCE</td>
                        <td>6958.85</td>
                        <td>6844.05</td>
                        <td>6935</td>
                        <td>66.65</td>
                        <td>0.97</td>
                    </tr>
                
                    <tr>
                        <td>APOLLOHOSP</td>
                        <td>7308.45</td>
                        <td>7215.2</td>
                        <td>7263</td>
                        <td>69.15</td>
                        <td>0.96</td>
                    </tr>
                
                    <tr>
                        <td>KOTAKBANK</td>
                        <td>1802.8</td>
                        <td>1783.25</td>
                        <td>1799.1</td>
                        <td>12.85</td>
                        <td>0.72</td>
                    </tr>
                
                    <tr>
                        <td>ICICIBANK</td>
                        <td>1332</td>
                        <td>1315.25</td>
                        <td>1331.35</td>
                        <td>9.05</td>
                        <td>0.68</td>
                    </tr>
                
                    <tr>
                        <td>M&amp;M</td>
                        <td>3081.25</td>
                        <td>3005.3</td>
                        <td>3066</td>
                        <td>14.75</td>
                        <td>0.48</td>
                    </tr>
                
                    <tr>
                        <td>COALINDIA</td>
                        <td>417.2</td>
                        <td>411.5</td>
                        <td>415.5</td>
                        <td>1.5</td>
                        <td>0.36</td>
                    </tr>
                
                    <tr>
                        <td>TITAN</td>
                        <td>3516.95</td>
                        <td>3436.05</td>
                        <td>3479.9</td>
                        <td>11.7</td>
                        <td>0.34</td>
                    </tr>
                
                    <tr>
                        <td>TATASTEEL</td>
                        <td>152.5</td>
                        <td>149.31</td>
                        <td>150.38</td>
                        <td>0.5</td>
                        <td>0.33</td>
                    </tr>
                
                    <tr>
                        <td>TATAMOTORS</td>
                        <td>810.45</td>
                        <td>797.45</td>
                        <td>801</td>
                        <td>2.25</td>
                        <td>0.28</td>
                    </tr>
                
                    <tr>
                        <td>SUNPHARMA</td>
                        <td>1823</td>
                        <td>1796</td>
                        <td>1809</td>
                        <td>2.35</td>
                        <td>0.13</td>
                    </tr>
                
                    <tr>
                        <td>BRITANNIA</td>
                        <td>4829.95</td>
                        <td>4783.05</td>
                        <td>4799</td>
                        <td>6</td>
                        <td>0.13</td>
                    </tr>
                
                    <tr>
                        <td>JSWSTEEL</td>
                        <td>1023.5</td>
                        <td>1006.65</td>
                        <td>1013.1</td>
                        <td>1.2</td>
                        <td>0.12</td>
                    </tr>
                
                    <tr>
                        <td>INDUSINDBK</td>
                        <td>988.4</td>
                        <td>979.1</td>
                        <td>983.6</td>
                        <td>1</td>
                        <td>0.1</td>
                    </tr>
                
                    <tr>
                        <td>ITC</td>
                        <td>466.45</td>
                        <td>462.6</td>
                        <td>465.35</td>
                        <td>0.4</td>
                        <td>0.09</td>
                    </tr>
                
                    <tr>
                        <td>BEL</td>
                        <td>318.3</td>
                        <td>314</td>
                        <td>314.8</td>
                        <td>0.2</td>
                        <td>0.06</td>
                    </tr>
                
                    <tr>
                        <td>ASIANPAINT</td>
                        <td>2404.65</td>
                        <td>2385.05</td>
                        <td>2392.6</td>
                        <td>0.75</td>
                        <td>0.03</td>
                    </tr>
                
                    <tr>
                        <td>HEROMOTOCO</td>
                        <td>4614.95</td>
                        <td>4561.7</td>
                        <td>4597</td>
                        <td>1.05</td>
                        <td>0.02</td>
                    </tr>
                
                    <tr>
                        <td>HINDUNILVR</td>
                        <td>2413</td>
                        <td>2388.3</td>
                        <td>2399.45</td>
                        <td>-1.3</td>
                        <td>-0.05</td>
                    </tr>
                
                    <tr>
                        <td>HDFCBANK</td>
                        <td>1877.7</td>
                        <td>1858.55</td>
                        <td>1867.65</td>
                        <td>-2.35</td>
                        <td>-0.13</td>
                    </tr>
                
                    <tr>
                        <td>BPCL</td>
                        <td>306.7</td>
                        <td>300.85</td>
                        <td>303</td>
                        <td>-0.45</td>
                        <td>-0.15</td>
                    </tr>
                
                    <tr>
                        <td>HINDALCO</td>
                        <td>676</td>
                        <td>664.7</td>
                        <td>669.8</td>
                        <td>-1.1</td>
                        <td>-0.16</td>
                    </tr>
                
                    <tr>
                        <td>NTPC</td>
                        <td>371.2</td>
                        <td>366.4</td>
                        <td>368.9</td>
                        <td>-0.95</td>
                        <td>-0.26</td>
                    </tr>
                
                    <tr>
                        <td>TCS</td>
                        <td>4493.8</td>
                        <td>4412.1</td>
                        <td>4437.8</td>
                        <td>-14.35</td>
                        <td>-0.32</td>
                    </tr>
                
                    <tr>
                        <td>POWERGRID</td>
                        <td>331.85</td>
                        <td>325.35</td>
                        <td>328</td>
                        <td>-1.1</td>
                        <td>-0.33</td>
                    </tr>
                
                    <tr>
                        <td>NESTLEIND</td>
                        <td>2240</td>
                        <td>2210</td>
                        <td>2219</td>
                        <td>-9.85</td>
                        <td>-0.44</td>
                    </tr>
                
                    <tr>
                        <td>ULTRACEMCO</td>
                        <td>11807.1</td>
                        <td>11695</td>
                        <td>11760</td>
                        <td>-54.8</td>
                        <td>-0.46</td>
                    </tr>
                
                    <tr>
                        <td>SBILIFE</td>
                        <td>1483.9</td>
                        <td>1451.6</td>
                        <td>1462</td>
                        <td>-7.3</td>
                        <td>-0.5</td>
                    </tr>
                
                    <tr>
                        <td>TATACONSUM</td>
                        <td>938.6</td>
                        <td>925.2</td>
                        <td>929.3</td>
                        <td>-4.65</td>
                        <td>-0.5</td>
                    </tr>
                
                    <tr>
                        <td>MARUTI</td>
                        <td>11314.35</td>
                        <td>11170</td>
                        <td>11219.8</td>
                        <td>-60</td>
                        <td>-0.53</td>
                    </tr>
                
                    <tr>
                        <td>EICHERMOT</td>
                        <td>4874.9</td>
                        <td>4797.5</td>
                        <td>4815.6</td>
                        <td>-26.5</td>
                        <td>-0.55</td>
                    </tr>
                
                    <tr>
                        <td>LT</td>
                        <td>3963.5</td>
                        <td>3901.3</td>
                        <td>3922.95</td>
                        <td>-24.35</td>
                        <td>-0.62</td>
                    </tr>
                
                    <tr>
                        <td>BAJAJ-AUTO</td>
                        <td>9094.9</td>
                        <td>8980</td>
                        <td>9013.65</td>
                        <td>-63.8</td>
                        <td>-0.7</td>
                    </tr>
                
                    <tr>
                        <td>AXISBANK</td>
                        <td>1165.05</td>
                        <td>1151.25</td>
                        <td>1155</td>
                        <td>-8.25</td>
                        <td>-0.71</td>
                    </tr>
                
                    <tr>
                        <td>RELIANCE</td>
                        <td>1294.9</td>
                        <td>1280.2</td>
                        <td>1285.95</td>
                        <td>-9.2</td>
                        <td>-0.71</td>
                    </tr>
                
                    <tr>
                        <td>CIPLA</td>
                        <td>1479</td>
                        <td>1452.3</td>
                        <td>1457</td>
                        <td>-12</td>
                        <td>-0.82</td>
                    </tr>
                
                    <tr>
                        <td>ONGC</td>
                        <td>258.75</td>
                        <td>254.5</td>
                        <td>256.7</td>
                        <td>-2.2</td>
                        <td>-0.85</td>
                    </tr>
                
                    <tr>
                        <td>TECHM</td>
                        <td>1777</td>
                        <td>1753.3</td>
                        <td>1762.15</td>
                        <td>-15.7</td>
                        <td>-0.88</td>
                    </tr>
                
                    <tr>
                        <td>GRASIM</td>
                        <td>2708</td>
                        <td>2641.1</td>
                        <td>2654</td>
                        <td>-27.4</td>
                        <td>-1.02</td>
                    </tr>
                
                    <tr>
                        <td>TRENT</td>
                        <td>6959.95</td>
                        <td>6810</td>
                        <td>6875</td>
                        <td>-74.7</td>
                        <td>-1.07</td>
                    </tr>
                
                    <tr>
                        <td>HDFCLIFE</td>
                        <td>644.45</td>
                        <td>630.35</td>
                        <td>634.8</td>
                        <td>-7</td>
                        <td>-1.09</td>
                    </tr>
                
                    <tr>
                        <td>ADANIENT</td>
                        <td>2501</td>
                        <td>2455</td>
                        <td>2467.5</td>
                        <td>-28.35</td>
                        <td>-1.14</td>
                    </tr>
                
                    <tr>
                        <td>ADANIPORTS</td>
                        <td>1272.9</td>
                        <td>1244.4</td>
                        <td>1252</td>
                        <td>-14.85</td>
                        <td>-1.17</td>
                    </tr>
                
                    <tr>
                        <td>DRREDDY</td>
                        <td>1253.6</td>
                        <td>1233</td>
                        <td>1238.4</td>
                        <td>-16.75</td>
                        <td>-1.33</td>
                    </tr>
                
                    <tr>
                        <td>BHARTIARTL</td>
                        <td>1611.85</td>
                        <td>1570.05</td>
                        <td>1580.05</td>
                        <td>-22.5</td>
                        <td>-1.4</td>
                    </tr>
                
            </tbody>
        </table>
    </div>
                <div id="error-message" class="error mt-3"></div>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true" wfd-invisible="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="uploadModalLabel">Upload CSV File</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="upload-form" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="file" class="form-label">Select CSV File:</label>
                            <input type="file" id="file" name="file" accept=".csv" class="form-control" required="">
                        </div>
                        <div class="mb-3">
                            <label for="folder" class="form-label">Folder Name:</label>
                            <input type="text" id="folder" name="folder" class="form-control" placeholder="Enter folder name" required="">
                        </div>
                        <button type="submit" class="btn btn-primary">Upload</button>
                    </form>
                    <div id="upload-result" class="mt-3"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script wfd-invisible="true">
        const apiUrl = "http://127.0.0.1:8080"; // Base URL of the Flask app

        // Handle CSV upload
        document.getElementById('upload-form').addEventListener('submit', async function(event) {
            event.preventDefault();
            const formData = new FormData();
            const fileInput = document.getElementById('file');
            const folderInput = document.getElementById('folder');
            formData.append('file', fileInput.files[0]);
            formData.append('folder', folderInput.value);

            try {
                const response = await fetch(`${apiUrl}/upload`, {
                    method: "POST",
                    body: formData
                });
                const result = await response.json();

                if (response.ok) {
                    document.getElementById('upload-result').innerHTML = 
                        `<div class="alert alert-success">${result.message}<br>Rows processed: ${result.rows}<br>Columns: ${result.columns.join(", ")}</div>`;
                } else {
                    document.getElementById('upload-result').innerHTML = `<div class="alert alert-danger">Error: ${result.error}</div>`;
                }
            } catch (error) {
                document.getElementById('upload-result').innerHTML = `<div class="alert alert-danger">Error uploading file: ${error.message}</div>`;
            }
        });

        // Populate dropdown and table on page load
        async function populateData() {
            const dropdown = document.getElementById("stock-select");
            const errorMessage = document.getElementById("error-message");
            const stocksTable = document.getElementById("stocks-table");
            errorMessage.textContent = ""; // Clear previous errors

            try {
                const response = await fetch(`${apiUrl}/stocks`);
                if (!response.ok) throw new Error("Failed to fetch stocks");
                const stocks = await response.json();

                // Populate dropdown
                stocks.forEach(stock => {
                    const option = document.createElement("option");
                    option.value = stock.Symbol;
                    option.textContent = `${stock.Symbol} - ${stock["Company Name"] || "N/A"}`;
                    dropdown.appendChild(option);
                });

                // Populate table with all stocks
                stocksTable.innerHTML = generateTable(stocks);
            } catch (error) {
                errorMessage.textContent = "Error loading stocks: " + error.message;
            }
        }

        // Handle stock selection
        async function handleStockSelection() {
            const dropdown = document.getElementById("stock-select");
            const symbol = dropdown.value;
            const errorMessage = document.getElementById("error-message");
            const stocksTable = document.getElementById("stocks-table");
            errorMessage.textContent = ""; // Clear previous errors

            if (symbol === "all") {
                // Fetch and display all stocks
                populateData();
                return;
            }

            try {
                const response = await fetch(`${apiUrl}/stocks/${symbol}`);
                if (!response.ok) throw new Error("Failed to fetch stock data");
                const stock = await response.json();
                stocksTable.innerHTML = generateTable([stock]); // Show only the selected stock
            } catch (error) {
                errorMessage.textContent = "Error fetching stock data: " + error.message;
            }
        }

        // Generate a table from stock data
function generateTable(stocks) {
    if (!stocks.length) return "<p>No stock data available.</p>";
    
    return `
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Symbol</th>
                    <th>Day High</th>
                    <th>Day Low</th>
                    <th>Last Price</th>
                    <th>Change</th>
                    <th>PChange</th>
                </tr>
            </thead>
            <tbody>
                ${stocks.map(stock => `
                    <tr>
                        <td>${stock.Symbol}</td>
                        <td>${stock["Day High"]}</td>
                        <td>${stock["Day Low"]}</td>
                        <td>${stock["Last Price"]}</td>
                        <td>${stock["Change"]}</td>
                        <td>${stock["PChange"]}</td>
                    </tr>
                `).join("")}
            </tbody>
        </table>
    `;
}

        document.addEventListener("DOMContentLoaded", populateData);
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" wfd-invisible="true"></script>

</body></html>